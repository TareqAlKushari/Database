CREATE TABLE BRANCH (
    BID       INTEGER    PRIMARY KEY,
    BRNAME    CHAR(30)   NOT NULL,
    BRCITY    CHAR(10)   NOT NULL
);
DESCRIBE BRANCH;

CREATE TABLE CUSTOMER (
    CNO     INTEGER   PRIMARY KEY,
    CNAME   CHAR(20)  NOT NULL,
    CADDR   CHAR(35)  NOT NULL,
    CITY    CHAR(20)  NOT NULL,
    BID     INTEGER   NOT NULL,
    FOREIGN KEY (BID) REFERENCES BRANCH(BID) ON DELETE CASCADE
); 
DESCRIBE CUSTOMER;

CREATE TABLE LOAN_APPLICATION (
    BID           INTEGER   NOT NULL,
    CNO           INTEGER   NOT NULL,
    LNO           INTEGER   PRIMARY KEY,
    LAMTREQUIRED  INTEGER   NOT NULL,
    LAMTAPPROVED  INTEGER   NOT NULL,
    L_DATE        DATE      NOT NULL,
    FOREIGN KEY (BID) REFERENCES BRANCH(BID) ON DELETE CASCADE,
    FOREIGN KEY (CNO) REFERENCES CUSTOMER(CNO) ON DELETE CASCADE
);
DESCRIBE LOAN_APPLICATION;

INSERT INTO BRANCH VALUES(1, 'Al Rajhi Bank', 'Riyadh');
INSERT INTO BRANCH VALUES(2, 'Riyad Bank', 'Riyadh');
INSERT INTO BRANCH VALUES(3, 'anb Bank', 'Riyadh');
INSERT INTO BRANCH VALUES(4, 'Enjaz', 'Jeddah');
INSERT INTO BRANCH VALUES(5, 'Saudi National Bank', 'Riyadh');
INSERT INTO BRANCH VALUES(6, 'Bank AlJazira', 'Jeddah');

SELECT * FROM BRANCH;

INSERT INTO CUSTOMER VALUES(1, 'Jana Debsan', 'Any Thing', 'Jeddah', 6);
INSERT INTO CUSTOMER VALUES(2, 'Lina Alhajri', 'Any Thing', 'Riyadh', 2);
INSERT INTO CUSTOMER VALUES(3, 'Raneem Alsakib', 'Any Thing', 'Riyadh', 3);
INSERT INTO CUSTOMER VALUES(4, 'Muneerah Alsubie', 'Any Thing', 'Jeddah', 4);
INSERT INTO CUSTOMER VALUES(5, 'Ahad Aljahmi', 'Any Thing', 'Riyadh', 1);
INSERT INTO CUSTOMER VALUES(6, 'Lara Whetan', 'Any Thing', 'Riyadh', 5);

SELECT * FROM CUSTOMER;

INSERT INTO LOAN_APPLICATION VALUES(6, 1, 1, 1000, 1000, SYSDATE);
INSERT INTO LOAN_APPLICATION VALUES(2, 2, 2, 1095, 1095, SYSDATE);
INSERT INTO LOAN_APPLICATION VALUES(3, 3, 3, 1087, 1087, SYSDATE);
INSERT INTO LOAN_APPLICATION VALUES(4, 4, 4, 1093, 1093, SYSDATE);
INSERT INTO LOAN_APPLICATION VALUES(1, 5, 5, 1082, 1082, SYSDATE);
INSERT INTO LOAN_APPLICATION VALUES(5, 6, 6, 1080, 1080, SYSDATE);

SELECT * FROM LOAN_APPLICATION;

SELECT c.CNAME, b.BRNAME
FROM CUSTOMER c
INNER JOIN BRANCH b ON c.BID = b.BID;

SELECT BRCITY
FROM BRANCH
WHERE BRCITY LIKE 'R%'; 

ALTER TABLE LOAN_APPLICATION
DROP COLUMN LNO;
SELECT * FROM LOAN_APPLICATION;  

SELECT CNO, CNAME, (REGEXP_COUNT(CNAME, '[A-Z]') + REGEXP_COUNT(CNAME, '[a-z]') + REGEXP_COUNT(CNAME, ' [A-Z]') + REGEXP_COUNT(CNAME, ' [a-z]')) "Name Length"
FROM CUSTOMER;

SELECT BID, UPPER(BRNAME) AS NameInUpperCase
FROM BRANCH;

SELECT CNO, CNAME || ' - ' || CITY AS FullInfo
FROM CUSTOMER;

SELECT COUNT(*) AS number_of_rows,
       MIN(LAMTREQUIRED) AS minimum_money,
       MAX(LAMTREQUIRED) AS maximum_money,
       AVG(LAMTREQUIRED) AS average_money,
       SUM(LAMTREQUIRED) AS total_money
FROM LOAN_APPLICATION;

